% !TEX encoding = UTF-8 Unicode

\documentclass[a4paper]{article}

\usepackage{float}
\usepackage{color}
\usepackage{url}
\usepackage[T2A]{fontenc} % enable Cyrillic fonts
\usepackage[utf8]{inputenc} % make weird characters work
\usepackage{graphicx}

\usepackage[english,serbian]{babel}

\usepackage[unicode]{hyperref}
\hypersetup{colorlinks,citecolor=green,filecolor=green,linkcolor=blue,urlcolor=blue}

\newtheorem{primer}{Primer}[section]
\newcommand\todo[1]{\textcolor{red}{#1}}

\begin{document}

\title{Kako i zašto funkcioniše blockchain?\\ \small{Seminarski rad u okviru kursa\\Tehničko i naučno pisanje\\ Matematički fakultet}}
\author{
    Lazić, Jovana\\ 
    \texttt{kontakt email adresa autora}
    \and
    Nikić, Ognjen\\ 
    \texttt{kontakt email adresa autora}
    \and
    Nešković, Ognjen\\ 
    \texttt{mi22009@alas.matf.bg.ac.rs}
    \and
    Sekešan, Pavle\\ 
    \texttt{kontakt email adresa autora}
}
\date{\today}
\maketitle

\abstract{
U radu su sažeto iznete osnove kriptografije potrebne za razumevanje i implementaciju blokčejna. Ukratko je predstavljena istorija blokčejna, kao i glavne ideje potrebne za realizaciju blokčejna koji se nalazi iza jedne od najpoznatijih kriptovaluta - Bitcoin. \todo{Dopuniti kasnije...}
\tableofcontents

\newpage

\section{Uvod}
\label{sec:uvod}
\todo{Napisati uvod - ukratko nešto o istoriji blokčejna, čemu služi, zašto je koristan, pomenuti osnovne ideje koje se koriste (heširanje, merkle stabla, asimetrična kriptografija (digitalni potpisi) itd.)}

\section{Kriptografske osnove}	
\label{sec:kriptografske_osnove}

\subsection{Kriptografske heš funkcije}
\todo{Napisati ovaj subsection}

\subsection{Asimetrična kriptografija}
\todo{Napisati ovaj subsection}

\section{Blokčejn}
\label{sec:blockchain}

Blokčejn je decentralizovan, distribuiran i najčešće javan skup podataka (najčešće transakcija ili drugih zapisa) \cite{wood2014ethereum} sačinjen od manjih jedinica podataka - ''blokova''.
Blokovi su takvi da se dati blok ne može izmeniti bez promene svih blokova koji dolaze nakon njega. Ovim blokovi uspostavljaju ''istoriju'', odnosno sekvencu izmena na javnom skupu podataka.
\begin{figure}[H]
    \centering
        \includegraphics[scale=0.3]{bitcoin_blockchain_diagram.pdf}
    \caption{Bitcoin blokčejn}
    \label{fig:btc_blockchain}
\end{figure}
Na primer u slučaju Bitcoin blokčejna (slika \ref{fig:btc_blockchain}) blokovi sadrže, pored ostalog, heš prethodnog bloka i transakcije (preciznije merkle stablo izgrađeno nad transakcijama).
Time što jedan blok sadrži heš bloka koji je kreiran pre njega je uspostavljen redosled blokova, pa i time redosled transakcija.
Neke izmene nad skupom podataka moraju biti odobrene od strane pojedinca kome podaci pripadaju (na primer u slučaju transakcija) što se postiže metodama asimetrične kriptografije.
Svi učesnici u distribuiranoj mreži mogu lako verifikovati da li su izmene u blokčejnu validne i složiti se sa izmenama ili glasati protiv njih.
Kako bi se došlo do konsenzusa oko toga koja sekvenca izmena na blokčejnu je validna uvode se metode poput dokaza o izvršenom radu (proof of work), dokaza o posedovanju valute (proof of stake) itd.
Metode za postizanje konsenzusa se biraju tako da se postigne veliki stepen otpornosti prema ne-kooperativnim agentima u distribuiranoj mreži.
Zajedno sa javno dostupnim blokčejnom ovaj sistem rešava jedan od značajnih problema digitalnih dobara poznat kao ''double spending''. \cite{nakamoto2008bitcoin}

\subsection{Blokovi}
Blokovi su manji skupovi podataka koji se povezuju kako bi formirali krajnji lanac blokova (tj. blokčejn).
Članovi distribuirane mreže (tj. korisnici blokčejna) objavljuju javno izmene koje žele da se dogode.
Članovi zatim skupljaju veći broj izmena i spajaju ih da formiraju jedan blok.
Svaki blok sadrži heš (dobijen pomoću kriptografski bezbedne heš funkcije) prethodnog bloka.
Ovim je uspostavljen redosled blokova u lancu. Dodatno modifikacija nekog bloka postaje znatno teža jer ukoliko
bi neki čvor u distribuiranoj mreži izmenio neki blok i tako izmenjen lanac prosledio dalje u mrežu
ostali čvorovi bi lako videli da je blok izmenjen na sledeći način:\\
Neka je redosled blokova $b_0,b_1,...,b_n$ i neka je pokušana izmena na bloku $i$ i on je izmenjen u novi blok $x$:
$b_0,b_1,...,b_{i-1},x,b_{i+1},...,b_n$.
Uz svaki blok $j$ je sačuvana heš vrednost $h_j$. Kada neki čvor dobije novi lanac blokova i njihove heš vrednosti vrši se verifikacija
tako što čvor ponovo sračuna heš vrednosti blokova. Neka je heš funkcija $f$, onda se heš bloka $j$ računa kao
$h_j = f(h_{j-1},b_j)$. Dakle na izmenjenom lancu bi bilo $h'_{i+1} = f(x,b_{i+1})$. Kako je blok $x \neq b_i$ jasno je
da je $f(x,b_{i+1}) \neq f(b_{i},b_{i+1})$ (tj. novosračunata vrednost $h'_{i+1}$ će se razlikovati od dobijene vrednosti $h_{i+1}$).
Slično je i za vrednosti $h'_{i+2},h'_{i+3},...h'_{n}$ - kako je $h'_{i+1} \neq h_{i+1}$ onda će se i ostale vrednosti razlikovati.\\
Ovako je detektovana modifikacija na bloku $i$ i utvrđeno je da je lanac nevalidan.
Kako bi neko uspeo da izmeni jedan blok u lancu neophodno je da izmeni i ostale blokove i ponovo sračuna
heš vrednosti kako bi dobio validan blokčejn. 

\subsection{Decentralizacija}
Umesto jednog centralnog autoriteta poput servera ili banke blokčejn koristi decentralizovanu, distribuiranu mrežu
koja funkcioniše na "peer-to-peer" osnovi. "Peer-to-peer" komunikacija podrazumeva da se čvorovi u mreži ponašaju
kao server i kao klijent, odnosno drugi čvorovi mogu tražiti podatke od njih, a i oni mogu tražiti podatke od drugih čvorova u mreži.
Glavni izazov pri implementaciji distribuirane baze podataka je kome verovati da ima ispravnu verziju podataka -
kako osigurati da mreža funkcioniše iako postoje čvorovi koji žele namerno da lažiraju podatke
u svoju koristi ili ako postoje čvorovi koji ne funkcionišu ispravno. Suštinski, pitanje je kako da
"pošteni" čvorovi dostignu koncenzus iako deo mreže ne sarađuje. Ovaj problem se često naziva "problem vizantijskih generala" (eng. Byzantine generals problem).
Blokčejnovi najčešće koriste digitalne potpise zajedno sa algoritmom za postizanje koncenzusa poput "proof of work", "proof of stake" ili slično.
Čime se postiže otpornost mreže čak do 50\% nekooperativnih čvorova.
"Proof of work" mehanizam funkcioniše tako što pri kreaciji bloka član mreže mora da uloži značajnu računarsku
moć kako bi rešio težak algoritamski problem. Na primer u Bitcoin blokčejnu pri kreaciji novog bloga se vrše sledeći koraci:
\begin{enumerate}
    \item Prikupljaju se transakcije koje će biti u novom bloku
    \item Inicijalizuje se ''nonce'' vrednost na 0
    \item Računa se heš vrednost transakcija koje treba staviti u blok, heš vrednosti prethodnog bloka i nonce vrednosti
    \item Ukoliko tako dobijena heš vrednost počinje sa $k$ nula, blok je validan i čvor ga prosleđuje ostatku mreže.
    \item Inače uvećava se nonce vrednost za jedan i ponavo se računa heš vrednost dok se ne dobije $k$ nula na početku.
\end{enumerate}

\todo{Napisati ovaj subsection - opisati kako blokčejn koristi peer to peer mrežu, sa konkretnim primerom (na primer kako bitkojn radi broadcast ili šta već), prednosti i mane decentralizacije generalno - double spending ako neko ima preko 51\%, itd. }

\section{Primene}
\label{sec:primene}

\subsection{Kriptovalute}
\todo{Napisati ovaj subsection}

\subsection{Pametni ugovori}
\todo{Napisati ovaj subsection - pomenuti eth pošto btc nije turing complete}

\section{Zaključak}
\todo{Napisati ovaj subsection}

\addcontentsline{toc}{section}{Literatura}
\appendix


\bibliography{seminarski} 
\bibliographystyle{plain}



\end{document}
